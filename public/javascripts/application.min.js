function _ajax_request(a,c,f,b,e){if(jQuery.isFunction(c)){f=c;c={}}return jQuery.ajax({type:e,url:a,data:c,success:f,dataType:b})}jQuery.extend({put:function(a,c,e,b){return _ajax_request(a,c,e,b,"PUT")},delete_:function(a,c,e,b){return _ajax_request(a,c,e,b,"DELETE")}});function field_focus(a){if(a.value==a.defaultValue){a.value="";$(a).removeClass("dim")}}function field_blur(a){if(a.value==""){a.value=a.defaultValue;$(a).addClass("dim")}}function fill_loot(b,a){$("#loot_item_name").attr("value",b);$("#loot_item_url").attr("value",a);if(b==""){field_blur($("#loot_item_name").get(0));field_blur($("#loot_item_url").get(0))}else{$("#loot_item_name, #loot_item_url").removeClass("dim")}}function fill_loot_with_location(c,a,b){fill_loot(c,a);$("#loot_location_id").val(b)}function swap_loot(){var a=$("#loot_item_url").attr("value");$("#loot_item_url").attr("value",$("#loot_item_name").attr("value"));$("#loot_item_name").attr("value",a)}function make_signup(a){$(a).draggable({helper:"clone",opacity:0.5,revert:false,revertDuration:250,scope:"signups",zIndex:5})}function make_slot(b,a){$(b).droppable({hoverClass:"hovering",scope:"signups",accept:a,drop:signup_dropped})}function signup_dropped(a,b){if(this.id=="waiting_list"){if(b.draggable.hasClass("slot")){slot_id=b.draggable.attr("id").replace(/^slot_/,"");$.delete_("/raids/"+raid_id+"/slots/"+slot_id,{authenticity_token:AUTH_TOKEN},null,"script")}}else{if(b.draggable.hasClass("slot")){from_slot_id=b.draggable.attr("id").replace(/^slot_/,"");data={from_slot_id:from_slot_id,_method:"put",authenticity_token:AUTH_TOKEN}}else{from_signup_id=b.draggable.attr("id").replace(/^signup_/,"");data={from_signup_id:from_signup_id,_method:"put",authenticity_token:AUTH_TOKEN}}slot_id=this.id.replace(/^slot/,"");$.put("/raids/"+raid_id+"/slots/"+slot_id,data,null,"script")}}function character_roles(b,a){$(a).html('<img src="/images/loading.gif">');$(a).load("/roles/"+b.value)}function validate_loot(){if($("#loot_item_name").attr("value")=="Name"||$("#loot_item_url").attr("value")=="URL"){alert("Please fill out the loot form before submitting");return false}else{if($("#loot_character_id").attr("value")==""){alert("A character must be seated and selected before you can assign loot");return false}else{return confirm("Are you sure you wish to assign loot?")}}}function wowhead_search(a){a=a.replace(/^\s+|\s+$/g,"");if(a!==""){$("#wowhead_search_loading_image").fadeIn();$.get("/wowhead/"+escape(a),"",function(b){wowhead_items(b);$("#wowhead_search_loading_image").fadeOut()},"json")}}function wowhead_items(b){$("ul#wowhead_results").empty();var a=b[1];if(a.length>0){var c=b[7];$.each(a,function(g,f){var e=c[g];if(e[0]===3&&e[3]===4){item_name=f.replace(/ \(Item\)/,"");item_url="http://www.wowhead.com/?item="+e[1];dd=$('<li><a href="'+item_url+'" onclick="fill_loot(unescape(\''+escape(item_name)+"'), unescape('"+escape(item_url)+"')); return false;\">"+item_name+"</a></li>");$("ul#wowhead_results").append(dd)}})}}function wowhead_pull(){$("#wowhead_search").val($("#loot_item_name").val());if($("#loot_item_name").val()!==""){$("#wowhead_search").change()}}function raid_edit_slots(a){if($(a).val()===""){$("select.slot_select").removeAttr("disabled")}else{$("select.slot_select").attr("disabled","disabled")}}function time_slot_data(c){var a=$(c).attr("id").match(/^schedule_([0-9]+)_([0-9]+)_([0-9]+)$/);var b=new Object();b.day=parseInt(a[1]);b.hour=parseFloat(a[2]+"."+a[3]);b.ele=$(c);return b}var selected_time_slot=null;var AUTH_TOKEN="";$(function(){$("dd > span.character").live("dblclick",function(){window.open("http://www.wowarmory.com/character-sheet.xml?r=Bronzebeard&n="+$(this).text(),"_blank")});AUTH_TOKEN=$("#auth_token").html();$("tr.log.hidden").hide();$("tr.log.shown").last().after($('<tr><td colspan="6"><a id="more_logs" href="#">Show More Logs ...</a></td></tr>'));$("#more_logs").click(function(){if($("tr.log.hidden").is(":visible")){$(this).html("Show More Logs ...")}else{$(this).html("Hide Logs ...")}$("tr.log.hidden").toggle();return false});$("dd#tags td span.stat").hide();$("dd#tags td span.stat.seated").show();$("#tag_select").change(function(){$("dd#tags td span.stat").hide();$("dd#tags td span.stat."+$(this).val()).show()});$("div#schedule").disableTextSelect();$("div#schedule div.time_slot").mousedown(function(){selected_time_slot=time_slot_data(this)});$("div#schedule div.time_slot").mouseover(function(){if(selected_time_slot!==null){var f=time_slot_data(this);var c=Math.min(selected_time_slot.day,f.day);var a=Math.max(selected_time_slot.day,f.day);var i=Math.min(selected_time_slot.hour,f.hour);var g=Math.max(selected_time_slot.hour,f.hour);$("div.time_slot.hover").removeClass("hover");for(d=c;d<=a;d++){for(h=i;h<=g;h+=0.5){var b=parseInt(h);var e=h==b?0:5;$("#schedule_"+d+"_"+b+"_"+e).addClass("hover")}}}});$("div#schedule div.time_slot").mouseup(function(){var f=time_slot_data(this);var c=Math.min(selected_time_slot.day,f.day);var a=Math.max(selected_time_slot.day,f.day);var j=Math.min(selected_time_slot.hour,f.hour);var g=Math.max(selected_time_slot.hour,f.hour);var i=!selected_time_slot.ele.hasClass("selected");for(d=c;d<=a;d++){for(h=j;h<=g;h+=0.5){var b=parseInt(h);var e=h==b?0:5;if(i){$("#schedule_"+d+"_"+b+"_"+e).addClass("selected")}else{$("#schedule_"+d+"_"+b+"_"+e).removeClass("selected")}}}$("div.time_slot.hover").removeClass("hover");selected_time_slot=null})});